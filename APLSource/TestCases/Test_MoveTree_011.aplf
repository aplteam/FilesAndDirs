 R←Test_MoveTree_011(stopFlag batchFlag);⎕TRAP;rc;more;list;successFlag;success;tempPathSource;tempPathTarget
⍝ Exercise `MoveTree`: move a tree of dirs and files.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 tempPathSource←##.FilesAndDirs.GetTempPath,'source_',↑⎕SI
 tempPathTarget←##.FilesAndDirs.GetTempPath,'target_',↑⎕SI
 {}##.FilesAndDirs.RmDir tempPathSource
 {}##.FilesAndDirs.RmDir tempPathTarget
 ∆CreateDirsAndFiles tempPathSource

 (success more list)←tempPathSource ##.FilesAndDirs.MoveTree tempPathTarget
 →T.GoToTidyUp 1≠success
 →T.GoToTidyUp 0≠≢more
 →T.GoToTidyUp∨/list[;1 2]∨.≠0 1

 R←T._OK

∆TidyUp:
 :Trap 0 ⋄ {}##.FilesAndDirs.RmDir tempPathSource ⋄ :EndTrap
 :Trap 0 ⋄ {}##.FilesAndDirs.RmDir tempPathTarget ⋄ :EndTrap
⍝Done
