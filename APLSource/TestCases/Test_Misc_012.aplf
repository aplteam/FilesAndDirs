 R←Test_Misc_012(stopFlag batchFlag);⎕TRAP;filename;buffer;wsPath;rc;en;more
⍝ Test the `PolishCurrentDir` method
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 wsPath←##.FilesAndDirs.GetTempSubDir'_',(⊃⎕SI)
 filename←wsPath,'/result.txt'
 ##.FilesAndDirs.DeleteFile filename
 Assert 0=##.FilesAndDirs.IsFile filename
 ('-x' 0)('RIDE_INIT' '')('path'wsPath)∆StartDyalogInstance'Tests/Test_Misc_012'
 ('-x' 1)('RIDE_INIT' 'Serve::9999')('path'wsPath)∆StartDyalogInstance'Tests/Test_Misc_012'
 →T.GoToTidyUp 0=1{20=⍺:0 ⋄ _←⎕DL 0.2 ⋄ ##.FilesAndDirs.IsFile ⍵:1 ⋄ (⍺+1)∇ ⍵}filename
 buffer←⊃##.FilesAndDirs.NGET filename 1
 ##.FilesAndDirs.DeleteFile filename
 →T.GoToTidyUp≢/##.FilesAndDirs.EnforceSlash¨wsPath(¯1↓1⊃buffer)
 →T.GoToTidyUp≢/{⍵/⍨3>+\'.'=⍵}¨(2⊃##.FilesAndDirs.Version)(2⊃buffer) ⍝ Error? Check whether Dist/ carries the latest version (required!)

 R←T._OK

∆TidyUp:
 ⎕DL 0.1
 (rc en more)←##.FilesAndDirs.RmDir wsPath
 Assert 0=rc
