 R←Test_CopyTree_010(stopFlag batchFlag);⎕TRAP;tempPath;more;list;successFlag;success;rc
⍝ Exercise `CopyTree`: copy an empty directory
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 tempPath←##.FilesAndDirs.GetTempPath,⊃⎕SI
 successFlag←'Create!'##.FilesAndDirs.CheckPath tempPath
 Assert successFlag
 (success more list)←tempPath ##.FilesAndDirs.CopyTree tempPath,'__copy/'
 →T.GoToTidyUp 1≠success
 →T.GoToTidyUp 0≠≢more
 →T.GoToTidyUp(,[0.5]{((≢1⊃⎕NPARTS tempPath)↓1⊃⍵)(2⊃⍵)(3⊃⍵)},list)≢(1 3⍴((⊃⎕SI),'__copy')0 '')

 R←T._OK

∆TidyUp:
 ##.FilesAndDirs.RmDir tempPath
 ##.FilesAndDirs.RmDir tempPath,'__copy/'
⍝Done
