 R←Test_CopyTree_012(stopFlag batchFlag);⎕TRAP;tempPath;more;list;successFlag;sucess;rc
⍝ Exercise `CopyTree` on a tree with a trailing separator on `source` (was once a bug).
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 tempPath←##.FilesAndDirs.GetTempPath,⊃⎕SI
 successFlag←'Create!'##.FilesAndDirs.CheckPath tempPath
 Assert successFlag
 (sucess more list)←(∆Home,##.FilesAndDirs.CurrentSep)##.FilesAndDirs.CopyTree tempPath
 →T.GoToTidyUp 1≠sucess
 →T.GoToTidyUp 0≠≢more
 →T.GoToTidyUp(1+≢↑('recursive' 1)##.FilesAndDirs.Dir ∆Home,'/')≠↑≢list
 →T.GoToTidyUp 0∨.≠list[;1]
 →T.GoToTidyUp 0∨.≠≢¨list[;2]
 →T.GoToTidyUp~∧/(1 ⎕NINFO¨list[;0])∊1 2  ⍝ The links should have transformed into files!

 R←T._OK

∆TidyUp:
 rc←##.FilesAndDirs.RmDir tempPath
