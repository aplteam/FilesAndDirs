 R←Test_MoveTree_016(stopFlag batchFlag);⎕TRAP;F;tempPathSource;tempPathTarget;rc;en;more;success;list;dirFlags
⍝ Exercise `MoveTree` with `source` having a trailing '/' but `target` does not. Was once a bug.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed
 :If 'Win'≢##.APLTreeUtils.GetOperatingSystem ⍬
     R←T._WindowsOnly
     :Return
 :Else
     F←##.FilesAndDirs
     tempPathSource←F.GetTempPath,'top',(↑⎕SI),'/'
     tempPathTarget←F.GetTempPath,'Top',(↑⎕SI),'/target_'
     (rc en more)←F.RmDir tempPathSource
     Assert 0=rc
     (rc en more)←F.RmDir tempPathTarget
     Assert 0=rc
     1 ∆CreateDirsAndFiles tempPathSource
     (success more list)←tempPathSource F.MoveTree tempPathTarget
     →T.GoToTidyUp 1≠success
     →T.GoToTidyUp 0≠≢more
     dirFlags←F.IsDir list[;0]
     →T.GoToTidyUp 2≠+/dirFlags
     →T.GoToTidyUp 1 1≢2↑¯1⌽dirFlags

     R←T._OK
 :EndIf
∆TidyUp:
 :Trap 0 ⋄ {}F.RmDir tempPathSource ⋄ :EndTrap
 :Trap 0 ⋄ {}F.RmDir tempPathTarget ⋄ :EndTrap
⍝Done
